import{H as e}from"./HeaderBar-9iVI5Imi.js";import{c as a,e as l,b as t,f as n,t as o,_ as s,g as i,F as r,l as d,i as c,v as m,n as u,p,j as v,s as g,o as y,d as h}from"./index-DNfTXETz.js";const f={class:"d-flex justify-content-between align-items-center mb-3"},_={class:"badge bg-secondary"},b={__name:"ResidentHeader",props:{count:Number},setup:e=>(s,i)=>(l(),a("div",f,[i[0]||(i[0]=t("h2",{class:"text-dark"},[t("i",{class:"fas fa-person-cane text-primary me-2"}),n(" Resident Management ")],-1)),t("span",_,o(e.count)+" Residents",1)]))},k={class:"table-responsive mb-4"},U={class:"table align-middle shadow-sm rounded overflow-hidden",style:{"background-color":"white"}},V={key:0},w=["onUpdate:modelValue"],x={key:1},S={key:0},E=["onUpdate:modelValue"],M={key:1},j={key:0},C=["onUpdate:modelValue"],I={key:1},P={key:0},T=["onUpdate:modelValue"],R={key:1},A={key:0},N=["onUpdate:modelValue"],F={key:1},O={key:0},D=["onUpdate:modelValue"],L={key:1},q={key:0},H=["onUpdate:modelValue"],$={key:1},B={class:"d-flex gap-2"},J=["onClick"],G=["onClick"],Y=s({__name:"ResidentTable",props:{residents:{type:Array,required:!0}},emits:["remove","save"],setup(e,{emit:s}){const u=e,p=s,v=i(null),g=()=>{const e=v.value,a=u.residents[e];a.allergies=a.allergiesString.split(",").map((e=>e.trim())),a.medications=a.medicationsString.split(",").map((e=>({name:e}))),v.value=null,p("save",a)};return(s,i)=>(l(),a("div",k,[t("table",U,[i[0]||(i[0]=t("thead",{style:{"background-color":"var(--primary)",color:"white"}},[t("tr",null,[t("th",null,"Name"),t("th",null,"Age"),t("th",null,"Room ID"),t("th",null,"Medical Notes"),t("th",null,"Allergies"),t("th",null,"Medications"),t("th",null,"Care Plan"),t("th",null,"Emergency Contact"),t("th",null,"Action")])],-1)),t("tbody",null,[(l(!0),a(r,null,d(e.residents,((e,s)=>(l(),a("tr",{key:e.id},[t("td",null,[v.value===s?(l(),a("div",V,[c(t("input",{"onUpdate:modelValue":a=>e.name=a,class:"form-control"},null,8,w),[[m,e.name]])])):(l(),a("div",x,o(e.name),1))]),t("td",null,[v.value===s?(l(),a("div",S,[c(t("input",{type:"number","onUpdate:modelValue":a=>e.age=a,class:"form-control",min:"0"},null,8,E),[[m,e.age,void 0,{number:!0}]])])):(l(),a("div",M,o(e.age),1))]),t("td",null,[v.value===s?(l(),a("div",j,[c(t("input",{"onUpdate:modelValue":a=>e.room_id=a,class:"form-control"},null,8,C),[[m,e.room_id]])])):(l(),a("div",I,o(e.room_id),1))]),t("td",null,[v.value===s?(l(),a("div",P,[c(t("input",{"onUpdate:modelValue":a=>e.medical_notes=a,class:"form-control"},null,8,T),[[m,e.medical_notes]])])):(l(),a("div",R,o(e.medical_notes||"-"),1))]),t("td",null,[v.value===s?(l(),a("div",A,[c(t("input",{"onUpdate:modelValue":a=>e.allergiesString=a,class:"form-control"},null,8,N),[[m,e.allergiesString]])])):(l(),a("div",F,o(e.allergies.join(", ")),1))]),t("td",null,[v.value===s?(l(),a("div",O,[c(t("input",{"onUpdate:modelValue":a=>e.medicationsString=a,class:"form-control"},null,8,D),[[m,e.medicationsString]])])):(l(),a("div",L,o(e.medications.map((e=>e.name)).join(", ")),1))]),t("td",null,[t("div",null,[t("ul",null,[(l(!0),a(r,null,d(e.care_plan,((e,s)=>(l(),a("li",{key:s},[t("strong",null,o(s)+":",1),n(" "+o(e.length)+" tasks ",1)])))),128))])])]),t("td",null,[v.value===s?(l(),a("div",q,[c(t("input",{"onUpdate:modelValue":a=>e.emergency_contact=a,class:"form-control"},null,8,H),[[m,e.emergency_contact]])])):(l(),a("div",$,o(e.emergency_contact||"-"),1))]),t("td",null,[t("div",B,[v.value!==s?(l(),a("button",{key:0,class:"btn btn-sm btn-outline-primary",onClick:e=>(e=>{const a=u.residents[e];a.allergiesString=a.allergies.join(", "),a.medicationsString=a.medications.map((e=>e.name)).join(", "),v.value=e})(s)}," Edit ",8,J)):(l(),a("button",{key:1,class:"btn btn-sm btn-success",onClick:g}," Save ")),t("button",{class:"btn btn-sm btn-danger",onClick:e=>(e=>{const a=u.residents[e].id;confirm(`Are you REALLY sure you want to delete ${u.residents[e].name}?`)&&(p("remove",a),v.value===e&&(v.value=null))})(s)}," Delete ",8,G)])])])))),128))])])]))}},[["__scopeId","data-v-12ab47f4"]]),z={class:"bg-white rounded shadow-sm p-4 mt-4"},K={class:"col-md-4"},Q={class:"col-md-2"},W={class:"col-md-2"},X={class:"col-md-2"},Z={class:"col-md-3"},ee={class:"col-md-3"},ae={class:"col-md-4"},le={class:"col-md-12"},te={class:"col-md-6"},ne={class:"col-md-6"},oe={class:"col-md-6"},se={class:"col-md-6"},ie={class:"col-md-12"},re={class:"col-md-6"},de={class:"col-md-12"},ce={class:"col-md-6"},me=s({__name:"ResidentForm",props:{resident:{type:Object,default:()=>({name:"",age:0,room_id:"",medical_notes:"",allergies:[],medications:[],care_plan:{},emergency_contact:""})}},emits:["add"],setup(e,{emit:o}){const s=e,i=o,r=u({...s.resident,allergiesInput:"",medicationsInput:"",carePlanMorning:"",carePlanEvening:"",gender:"",dob:"",nationality:"",resident_type:"",caregiver_notes:"",photo:null});p((()=>s.resident),(e=>Object.assign(r,e)),{deep:!0,immediate:!0});const d=()=>{const e={name:r.name,age:r.age,room_id:r.room_id,medical_notes:r.medical_notes,allergies:r.allergiesInput.split(",").map((e=>e.trim())),medications:r.medicationsInput.split(",").map((e=>e.trim())),care_plan:{Morning:r.carePlanMorning.split(",").map((e=>e.trim())),Evening:r.carePlanEvening.split(",").map((e=>e.trim()))},emergency_contact:r.emergency_contact};i("add",e)},y=e=>{const a=e.target.files[0];a&&(r.photo=a)};return(e,o)=>(l(),a("section",z,[o[18]||(o[18]=t("h5",{class:"mb-3 text-dark"},[t("i",{class:"fas fa-user-plus text-primary me-2"}),n(" Add New Resident ")],-1)),t("form",{class:"row g-3",onSubmit:g(d,["prevent"])},[t("div",K,[c(t("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>r.name=e),type:"text",class:"form-control",placeholder:"Name",required:""},null,512),[[m,r.name]])]),t("div",Q,[c(t("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>r.age=e),type:"number",class:"form-control",placeholder:"Age",min:"0",required:""},null,512),[[m,r.age,void 0,{number:!0}]])]),t("div",W,[c(t("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>r.room_id=e),type:"text",class:"form-control",placeholder:"Room ID",required:""},null,512),[[m,r.room_id]])]),t("div",X,[c(t("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>r.gender=e),class:"form-select"},o[15]||(o[15]=[t("option",{value:""},"Gender",-1),t("option",{value:"Male"},"Male",-1),t("option",{value:"Female"},"Female",-1),t("option",{value:"Other"},"Other",-1)]),512),[[v,r.gender]])]),t("div",Z,[c(t("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>r.dob=e),type:"date",class:"form-control",placeholder:"Date of Birth"},null,512),[[m,r.dob]])]),t("div",ee,[c(t("input",{"onUpdate:modelValue":o[5]||(o[5]=e=>r.nationality=e),type:"text",class:"form-control",placeholder:"Nationality"},null,512),[[m,r.nationality]])]),t("div",ae,[c(t("select",{"onUpdate:modelValue":o[6]||(o[6]=e=>r.resident_type=e),class:"form-select"},o[16]||(o[16]=[t("option",{value:""},"Resident Type",-1),t("option",{value:"Short Term"},"Short Term",-1),t("option",{value:"Long Term"},"Long Term",-1),t("option",{value:"Palliative Care"},"Palliative Care",-1)]),512),[[v,r.resident_type]])]),t("div",le,[c(t("textarea",{"onUpdate:modelValue":o[7]||(o[7]=e=>r.medical_notes=e),class:"form-control",placeholder:"Medical Notes",rows:"2"},null,512),[[m,r.medical_notes]])]),t("div",te,[c(t("input",{"onUpdate:modelValue":o[8]||(o[8]=e=>r.allergiesInput=e),type:"text",class:"form-control",placeholder:"Allergies (comma-separated)"},null,512),[[m,r.allergiesInput]])]),t("div",ne,[c(t("input",{"onUpdate:modelValue":o[9]||(o[9]=e=>r.medicationsInput=e),type:"text",class:"form-control",placeholder:"Medications (comma-separated)"},null,512),[[m,r.medicationsInput]])]),t("div",oe,[c(t("input",{"onUpdate:modelValue":o[10]||(o[10]=e=>r.carePlanMorning=e),type:"text",class:"form-control",placeholder:"Morning Tasks (comma-separated)"},null,512),[[m,r.carePlanMorning]])]),t("div",se,[c(t("input",{"onUpdate:modelValue":o[11]||(o[11]=e=>r.carePlanEvening=e),type:"text",class:"form-control",placeholder:"Evening Tasks (comma-separated)"},null,512),[[m,r.carePlanEvening]])]),t("div",ie,[c(t("textarea",{"onUpdate:modelValue":o[12]||(o[12]=e=>r.previous_medical_history=e),class:"form-control",placeholder:"Previous Medical History",rows:"2"},null,512),[[m,r.previous_medical_history]])]),t("div",re,[c(t("input",{"onUpdate:modelValue":o[13]||(o[13]=e=>r.emergency_contact=e),type:"text",class:"form-control",placeholder:"Emergency Contact"},null,512),[[m,r.emergency_contact]])]),t("div",de,[c(t("textarea",{"onUpdate:modelValue":o[14]||(o[14]=e=>r.caregiver_notes=e),class:"form-control",placeholder:"Notes for Caregivers",rows:"2"},null,512),[[m,r.caregiver_notes]])]),t("div",ce,[t("input",{type:"file",class:"form-control",onChange:y,accept:"image/*"},null,32)]),o[17]||(o[17]=t("div",{class:"col-12 text-center mt-3"},[t("button",{type:"submit",class:"btn pink px-4"},[t("i",{class:"fas fa-paper-plane me-1"}),n(" Submit ")])],-1))],32)]))}},[["__scopeId","data-v-9ff20449"]]),ue={class:"facility-page"},pe={class:"container my-4"},ve=s({__name:"ResidentManagement",setup(n){const o=i([]),s=async e=>{try{const a=await fetch("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw new Error("Failed to add");const l=await a.json();o.value.push(l.patient)}catch(a){console.error("Add error:",a)}},r=async e=>{try{if(!(await fetch(`/api/patients/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Failed to save");const a=o.value.findIndex((a=>a.id===e.id));-1!==a&&(o.value[a]=e)}catch(a){console.error("Save error:",a)}},d=async e=>{try{if(!(await fetch(`/api/patients/${e}`,{method:"DELETE"})).ok)throw new Error("Failed to delete");o.value=o.value.filter((a=>a.id!==e))}catch(a){console.error("Delete error:",a)}};return y((async()=>{try{const e=await fetch("/api/patients");if(!e.ok)throw new Error("Failed to fetch");o.value=await e.json()}catch(e){console.error("Fetch error:",e)}})),(n,i)=>(l(),a("div",ue,[h(e),t("main",pe,[h(b,{count:o.value.length},null,8,["count"]),h(Y,{residents:o.value,onSave:r,onRemove:d},null,8,["residents"]),h(me,{onAdd:s})])]))}},[["__scopeId","data-v-c9708ca0"]]);export{ve as default};
