import{a as e}from"./api-DWlUI4O7.js";import{H as a}from"./HeaderBar-9iVI5Imi.js";import{c as t,e as o,b as c,f as l,t as s,_ as i,g as n,n as d,o as r,p as u,F as p,l as m,i as v,j as y,v as f,q as b,a as g,s as h,d as x}from"./index-DNfTXETz.js";import"./index-BTvahscA.js";const F={class:"d-flex justify-content-between align-items-center mb-3"},k={class:"badge bg-secondary"},w={__name:"FacilityHeader",props:{count:Number},setup:e=>(a,i)=>(o(),t("div",F,[i[0]||(i[0]=c("h2",{class:"text-dark"},[c("i",{class:"fas fa-hospital-alt text-primary me-2"}),l(" Facility Management ")],-1)),c("span",k,s(e.count)+" Facilities",1)]))},V={class:"table-responsive mb-4"},U={class:"table align-middle shadow-sm rounded overflow-hidden",style:{"background-color":"white"}},_={class:"text-center"},C={class:"text-center"},S={key:0},j=["onUpdate:modelValue"],q={key:1},O={class:"text-center"},R={key:0},$=["onUpdate:modelValue"],A={key:1},E={class:"text-center"},I=["value"],M={class:"text-center"},D={key:0},H=["onUpdate:modelValue","max"],T={key:1},N={class:"text-center"},B={key:0},L=["onUpdate:modelValue"],Y={key:1},z={class:"text-center"},G=["onClick"],J=["onClick"],K=i({__name:"FacilityTable",props:{facilities:Array},setup(a){const i=n(null),g=a,h=d([]);r((async()=>{try{const a=await e.get("/rooms");h.splice(0,h.length,...a.data)}catch(a){console.error("Failed to fetch rooms:",a)}})),u((()=>h.map((e=>e.occupied))),(e=>{e.forEach(((e,a)=>{const t=h[a];"reserved"!==t.status&&"cleaning"!==t.status&&(t.status=0===e?"vacant":"occupied")}))}),{deep:!0}),u((()=>h.map((e=>e.status))),(e=>{e.forEach(((e,a)=>{const t=h[a];"vacant"===e||"reserved"===e||"cleaning"===e?t.occupied=0:"occupied"===e&&0===t.occupied&&(t.occupied=1)}))}),{deep:!0}),u((()=>g.facilities),(e=>{h.splice(0,h.length,...e)}),{immediate:!0,deep:!0});const x=async()=>{const a=h[i.value];try{await e.put(`/rooms/${a.id}`,a),i.value=null}catch(t){console.error("Failed to save room:",t)}};u((()=>h.map((e=>e.type))),((e,a)=>{e.forEach(((e,t)=>{e!==a[t]&&(h[t].capacity="single"===e?1:2,h[t].occupied>h[t].capacity&&(h[t].occupied=h[t].capacity))}))}),{deep:!0});return(a,n)=>(o(),t("div",V,[c("table",U,[n[6]||(n[6]=c("thead",{style:{"background-color":"var(--primary)",color:"white"}},[c("tr",null,[c("th",{class:"text-center"},"Room ID"),c("th",{class:"text-center"},"Type"),c("th",{class:"text-center"},"Floor"),c("th",{class:"text-center"},"Capacity"),c("th",{class:"text-center"},"Occupied"),c("th",{class:"text-center"},"Status"),c("th",{class:"text-center"},"Action")])],-1)),c("tbody",null,[(o(!0),t(p,null,m(h,((a,d)=>{return o(),t("tr",{key:d},[c("td",_,s(a.id),1),c("td",C,[i.value===d?(o(),t("div",S,[v(c("select",{"onUpdate:modelValue":e=>a.type=e,class:"form-select"},n[0]||(n[0]=[c("option",{value:"single"},"Single",-1),c("option",{value:"shared"},"Shared",-1)]),8,j),[[y,a.type]])])):(o(),t("div",q,s(a.type),1))]),c("td",O,[i.value===d?(o(),t("div",R,[v(c("select",{"onUpdate:modelValue":e=>a.floor=e,class:"form-select"},n[1]||(n[1]=[c("option",{value:"1F"},"1F",-1),c("option",{value:"2F"},"2F",-1)]),8,$),[[y,a.floor]])])):(o(),t("div",A,s(a.floor),1))]),c("td",E,[c("input",{class:"form-control text-center",value:a.capacity,readonly:"",style:{border:"none",background:"transparent"}},null,8,I)]),c("td",M,[i.value===d?(o(),t("div",D,[v(c("input",{type:"number",class:"form-control text-center","onUpdate:modelValue":e=>a.occupied=e,max:a.capacity,min:"0"},null,8,H),[[f,a.occupied,void 0,{number:!0}]])])):(o(),t("div",T,s(a.occupied),1))]),c("td",N,[i.value===d?(o(),t("div",B,[v(c("select",{"onUpdate:modelValue":e=>a.status=e,class:"form-select"},n[2]||(n[2]=[c("option",{value:"vacant"},"Vacant",-1),c("option",{value:"occupied"},"Occupied",-1),c("option",{value:"reserved"},"Reserved",-1),c("option",{value:"cleaning"},"Cleaning",-1)]),8,L),[[y,a.status]])])):(o(),t("div",Y,[c("span",{class:b(["badge rounded-pill px-3 py-2",{"bg-success":"vacant"===a.status,"bg-danger":"occupied"===a.status,"bg-warning text-dark":"reserved"===a.status,"bg-secondary":"cleaning"===a.status}])},s((r=a.status,r.charAt(0).toUpperCase()+r.slice(1))),3)]))]),c("td",z,[i.value!==d?(o(),t("button",{key:0,class:"btn btn-outline-primary btn-sm rounded-pill px-3",onClick:e=>(e=>{i.value=e})(d)},n[3]||(n[3]=[c("i",{class:"fas fa-edit me-1"},null,-1),l(" Edit ")]),8,G)):(o(),t("button",{key:1,class:"btn btn-success btn-sm rounded-pill px-3",onClick:x},n[4]||(n[4]=[c("i",{class:"fas fa-check me-1"},null,-1),l(" Save ")]))),c("button",{class:"btn btn-outline-danger btn-sm rounded-pill px-3",onClick:a=>(async a=>{const t=h[a];if(window.confirm(`Are you sure you want to delete room "${t.id}"?`))try{await e.delete(`/rooms/${t.id}`),h.splice(a,1)}catch(o){console.error("Failed to delete facility:",o)}})(d)},n[5]||(n[5]=[c("i",{class:"fas fa-trash-alt me-1"},null,-1)]),8,J)])]);var r})),128))])])]))}},[["__scopeId","data-v-15decbca"]]),P={class:"bg-white rounded shadow-sm p-4 mt-4"},Q={class:"col-md-2"},W={class:"col-md-2"},X={class:"col-md-2"},Z={class:"col-md-2"},ee={class:"col-md-2"},ae=["disabled"],te=["value"],oe=["value"],ce={class:"col-md-2"},le=i({__name:"FacilityForm",props:{room:{type:Object,default:()=>({id:"",type:"",floor:"",capacity:1,occupied:0,status:""})}},emits:["add"],setup(e,{emit:a}){const i=e,n=a,r=d({...i.room});u((()=>i.room),(e=>Object.assign(r,e)),{deep:!0,immediate:!0});const b=()=>{r.occupied>r.capacity?alert("Occupied cannot exceed Capacity"):n("add",{...r})};return(e,a)=>(o(),t("section",P,[a[12]||(a[12]=c("h5",{class:"mb-3 text-dark"},[c("i",{class:"fas fa-door-open text-primary me-2"}),l(" Add New Room ")],-1)),c("form",{class:"row g-3",onSubmit:h(b,["prevent"])},[c("div",Q,[v(c("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>r.id=e),class:"form-control",placeholder:"Room ID",required:""},null,512),[[f,r.id]])]),c("div",W,[v(c("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>r.type=e),class:"form-select",required:""},a[6]||(a[6]=[c("option",{disabled:"",value:""},"Type",-1),c("option",{value:"Single"},"Single",-1),c("option",{value:"Shared"},"Shared",-1)]),512),[[y,r.type]])]),c("div",X,[v(c("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>r.floor=e),class:"form-select",required:""},a[7]||(a[7]=[c("option",{disabled:"",value:""},"Floor",-1),c("option",null,"1F",-1),c("option",null,"2F",-1),c("option",null,"3F",-1)]),512),[[y,r.floor]])]),c("div",Z,[v(c("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>r.capacity=e),class:"form-select",required:""},a[8]||(a[8]=[c("option",{disabled:"",value:""},"Capacity",-1),c("option",{value:1},"1",-1),c("option",{value:2},"2",-1)]),512),[[y,r.capacity,void 0,{number:!0}]])]),c("div",ee,[v(c("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>r.occupied=e),class:"form-select",disabled:!r.capacity,required:""},[a[9]||(a[9]=c("option",{disabled:"",value:""},"Occupied",-1)),(o(!0),t(p,null,m(r.capacity,(e=>(o(),t("option",{key:e,value:e-1},s(e-1),9,te)))),128)),c("option",{value:r.capacity},s(r.capacity),9,oe)],8,ae),[[y,r.occupied,void 0,{number:!0}]])]),c("div",ce,[v(c("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>r.status=e),class:"form-select",required:""},a[10]||(a[10]=[g('<option disabled value="" data-v-9763946f>Status</option><option value="Vacant" data-v-9763946f>Vacant</option><option value="Occupied" data-v-9763946f>Occupied</option><option value="Reserved" data-v-9763946f>Reserved</option><option value="Cleaning" data-v-9763946f>Cleaning</option>',5)]),512),[[y,r.status]])]),a[11]||(a[11]=c("div",{class:"col-12 justify-content-center mt-3"},[c("button",{type:"submit",class:"btn pink px-4"},[c("i",{class:"fas fa-paper-plane me-1"}),l(" Submit ")])],-1))],32)]))}},[["__scopeId","data-v-9763946f"]]),se={class:"facility-page"},ie={class:"container my-4 facility-page"},ne=i({__name:"FacilityManagement",setup(l){const s=n({name:"",location:"",type:"",capacity:"",manager:"",status:""}),i=n([]);r((async()=>{try{const a=await e.get("/rooms");i.value=a.data}catch(t){console.error("Failed to load facilities:",t)}const a=document.querySelector(".notifications-btn");a&&a.addEventListener("click",(function(){alert("You have 2 facility alerts:\n- Facility inspection pending\n- Capacity limit exceeded")}))}));const d=async a=>{a.type||(a.type="single"),a.capacity="single"===a.type?1:2,a.status||(a.status="vacant"),a.floor||(a.floor="1F"),a.occupied>a.capacity&&(a.occupied=a.capacity),a.id||(a.id=function(e){const a=e.floor||"F";return`${a}-${Date.now()}-${Math.floor(1e3*Math.random())}`}(a));try{const t=await e.post("/rooms",a);i.value.push(t.data),s.value={id:"",name:"",location:"",type:"",capacity:0,manager:"",status:"vacant",floor:"1F",occupied:0}}catch(t){console.error("Failed to add facility:",t)}};const u=async a=>{const t=i.value[a];try{await e.delete(`/rooms/${t.id}`),i.value.splice(a,1)}catch(o){console.error("Failed to delete facility:",o)}};return(e,l)=>(o(),t("div",se,[x(a),c("main",ie,[x(w,{count:i.value.length},null,8,["count"]),x(K,{facilities:i.value,onRemove:u},null,8,["facilities"]),x(le,{facility:s.value,onAdd:d},null,8,["facility"])])]))}},[["__scopeId","data-v-651b27b9"]]);export{ne as default};
